# Regex Radar - Parsers Architecture

This document describes how Regex Radar parses source files into structured information that other components can use.

Its main features are:

- Provide incremental ASTs for (virtual) source files.
- Cache ASTs with invalidation / (minimal) reparsing on edits.
- Provide tree-sitter queries callers can use to extract information from the ASTs
- Cache & own the tree sitter instances (this requires manual memory management for the instances returned from the WASM binary).
- Be as language-agnostic as possible, implementing new languages should be fairly easy and straightforward.

## Tree Sitter
Regex Radar uses `tree-sitter`(https://tree-sitter.github.io/tree-sitter/) to implement its parsers. This brings the following advantages:

- A WASM binding with [`web-tree-sitter`](https://github.com/tree-sitter/tree-sitter/tree/master/lib/binding_web)
- A lot of grammars for programming languages available at [`tree-sitter-grammars`](https://github.com/tree-sitter-grammars) and [`tree-sitter`](https://github.com/tree-sitter)
- A powerful [query language](https://tree-sitter.github.io/tree-sitter/using-parsers/queries/1-syntax.html) to simplify extracting information from the ASTs.
- Is build with edits in mind, providing an [edit API](https://tree-sitter.github.io/tree-sitter/using-parsers/3-advanced-parsing.html#editing) to effeciently reparse changed documents. This synergizes well with incremental document synchronization that the LSP defines.

### Grammars
Grammars are generated by a build script, and copied to the consuming applications as part of their package scripts.